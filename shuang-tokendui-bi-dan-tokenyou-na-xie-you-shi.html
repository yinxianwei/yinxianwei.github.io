<!DOCTYPE html>
<html lang="zh-cn">
        <head>
                        <meta charset="utf-8" />
                        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                        <meta name="generator" content="Pelican" />
                        <title>åŒtokenå¯¹æ¯”å•tokenæœ‰å“ªäº›ä¼˜åŠ¿</title>
                        <link rel="stylesheet" href="https://blog.yinxianwei.com/theme/css/main.css" />
                                <link rel="stylesheet" href="/custom.css" />
    <meta name="description" content="JWT åŒ Token æœºåˆ¶ï¼ˆé€šå¸¸æŒ‡ Access Token + Refresh Tokenï¼‰çš„æ ¸å¿ƒç›®çš„åªæœ‰ä¸€å¥è¯ï¼š ğŸ‘‰ åœ¨ä¿è¯å®‰å…¨æ€§çš„å‰æä¸‹ï¼Œè®©ç”¨æˆ·â€œå°½é‡å°‘é‡æ–°ç™»å½•â€ã€‚ ä¸‹é¢æˆ‘ä»å• Token çš„é—® â€¦" />
        </head>

        <body id="index" class="home">
    <a href="https://github.com/yinxianwei">
            <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
    </a>
                <header id="banner" class="body">
                        <h1><a href="https://blog.yinxianwei.com/">ä¸€æçº¢æå‡ºå¢™æ¥</a></h1>
                        <nav><ul>
                                        <li><a href="/">é¦–é¡µ</a></li>
                                        <li><a href="/categories.html">åˆ†ç±»</a></li>
                                        <li><a href="/tags.html">æ ‡ç­¾</a></li>
                                        <li><a href="/archives.html">å½’æ¡£</a></li>
                        </ul></nav>
                </header><!-- /#banner -->
  <section id="content" class="body">
    <article>
      <header>
        <h1 class="entry-title">
          <a href="https://blog.yinxianwei.com/shuang-tokendui-bi-dan-tokenyou-na-xie-you-shi.html" rel="bookmark"
             title="Permalink to åŒtokenå¯¹æ¯”å•tokenæœ‰å“ªäº›ä¼˜åŠ¿">åŒtokenå¯¹æ¯”å•tokenæœ‰å“ªäº›ä¼˜åŠ¿</a></h1>
      </header>

      <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2025-12-19T00:00:00+08:00">
                Published: Fri 19 December 2025
        </abbr>

                <address class="vcard author">
                        By                                 <a class="url fn" href="https://blog.yinxianwei.com/author/yinxianwei.html">yinxianwei</a>
                </address>
        <p>In <a href="https://blog.yinxianwei.com/category/sui-bi.html">éšç¬”</a>.</p>
        
</footer><!-- /.post-info -->        <p>JWT <strong>åŒ Token æœºåˆ¶</strong>ï¼ˆé€šå¸¸æŒ‡ <strong>Access Token + Refresh Token</strong>ï¼‰çš„æ ¸å¿ƒç›®çš„åªæœ‰ä¸€å¥è¯ï¼š
ğŸ‘‰ <strong>åœ¨ä¿è¯å®‰å…¨æ€§çš„å‰æä¸‹ï¼Œè®©ç”¨æˆ·â€œå°½é‡å°‘é‡æ–°ç™»å½•â€</strong>ã€‚</p>
<p>ä¸‹é¢æˆ‘ä»<strong>å• Token çš„é—®é¢˜ â†’ åŒ Token å¦‚ä½•è§£å†³ â†’ å®é™…ä¼˜åŠ¿ â†’ é€‚ç”¨åœºæ™¯</strong>ï¼Œä¸€æ­¥ä¸€æ­¥è¯´æ˜ã€Œä¸ºä»€ä¹ˆè¦ç”¨åŒ Tokenã€ã€‚</p>
<hr>
<h2>ä¸€ã€å…ˆçœ‹å• Tokenï¼ˆåªæœ‰ Access Tokenï¼‰çš„é—®é¢˜</h2>
<p>å¦‚æœç³»ç»Ÿåªç”¨ä¸€ä¸ª JWTï¼ˆAccess Tokenï¼‰ï¼Œä½ ä¼šé‡åˆ°å‡ ä¸ªçŸ›ç›¾ç‚¹ï¼š</p>
<h3>1ï¸âƒ£ Token æœ‰æ•ˆæœŸé•¿ â†’ å®‰å…¨æ€§å·®</h3>
<ul>
<li>Token ä¸€æ—¦æ³„éœ²</li>
<li>æ”»å‡»è€…å¯ä»¥é•¿æœŸä½¿ç”¨</li>
<li><strong>æ— æ³•ä¸»åŠ¨å¤±æ•ˆ</strong>ï¼ˆJWT æ˜¯æ— çŠ¶æ€çš„ï¼‰</li>
</ul>
<h3>2ï¸âƒ£ Token æœ‰æ•ˆæœŸçŸ­ â†’ ç”¨æˆ·ä½“éªŒå·®</h3>
<ul>
<li>æ¯”å¦‚ 15 åˆ†é’Ÿè¿‡æœŸ</li>
<li>ç”¨æˆ·é¢‘ç¹è¢«è¸¢ä¸‹çº¿</li>
<li>å‰ç«¯è¦åå¤ç™»å½•</li>
</ul>
<blockquote>
<p>âš ï¸ æœ¬è´¨å†²çªï¼š
<strong>å®‰å…¨ = çŸ­æœ‰æ•ˆæœŸ</strong>
<strong>ä½“éªŒ = é•¿æœ‰æ•ˆæœŸ</strong></p>
</blockquote>
<p>å• Token æ— æ³•åŒæ—¶æ»¡è¶³ã€‚</p>
<hr>
<h2>äºŒã€åŒ Token æ˜¯æ€ä¹ˆè§£å†³è¿™ä¸ªçŸ›ç›¾çš„ï¼Ÿ</h2>
<h3>åŒ Token ç»“æ„</h3>
<table>
<thead>
<tr>
<th>Token ç±»å‹</th>
<th>ä½œç”¨</th>
<th>æœ‰æ•ˆæœŸ</th>
<th>ä½¿ç”¨é¢‘ç‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>Access Token</td>
<td>æ¥å£é‰´æƒ</td>
<td>çŸ­ï¼ˆ10ï½30 åˆ†é’Ÿï¼‰</td>
<td>é«˜é¢‘</td>
</tr>
<tr>
<td>Refresh Token</td>
<td>æ¢æ–° Access Token</td>
<td>é•¿ï¼ˆ7ï½30 å¤©ï¼‰</td>
<td>ä½é¢‘</td>
</tr>
</tbody>
</table>
<hr>
<h3>æµç¨‹ç¤ºæ„</h3>
<div class="highlight"><pre><span></span><code>ç™»å½•
 â†“
è¿”å›ï¼š
<span class="k">-</span> access_tokenï¼ˆçŸ­æœŸï¼‰
<span class="k">-</span> refresh_tokenï¼ˆé•¿æœŸï¼‰

è¯·æ±‚æ¥å£
 â†“
access_token è¿‡æœŸï¼Ÿ
  â†“ æ˜¯
ç”¨ refresh_token æ¢æ–°çš„ access_token
</code></pre></div>

<hr>
<h2>ä¸‰ã€åŒ Token çš„æ ¸å¿ƒä¼˜åŠ¿ï¼ˆé‡ç‚¹ï¼‰</h2>
<h3>âœ… 1. Access Token æ³„éœ²ï¼Œé£é™©å¯æ§</h3>
<ul>
<li>Access Token <strong>æœ‰æ•ˆæœŸå¾ˆçŸ­</strong></li>
<li>
<p>å°±ç®—è¢«æˆªè·ï¼š</p>
</li>
<li>
<p>æœ€å¤šåªèƒ½ç”¨åå‡ åˆ†é’Ÿ</p>
</li>
<li><strong>æ— æ³•æ— é™æœŸè°ƒç”¨æ¥å£</strong></li>
</ul>
<p>ğŸ“Œ å®‰å…¨æ€§å¤§å¹…æå‡</p>
<hr>
<h3>âœ… 2. Refresh Token å¯æ§ã€å¯å¤±æ•ˆ</h3>
<p>Refresh Token é€šå¸¸ï¼š</p>
<ul>
<li><strong>åªå­˜æœåŠ¡ç«¯ï¼ˆæ•°æ®åº“ / Redisï¼‰</strong></li>
<li>
<p>å¯ä»¥åšåˆ°ï¼š</p>
</li>
<li>
<p>æ‰‹åŠ¨åŠé”€</p>
</li>
<li>ç”¨æˆ·é€€å‡ºç™»å½•å³å¤±æ•ˆ</li>
<li>å¼‚åœ°ç™»å½•è¸¢ä¸‹çº¿</li>
</ul>
<div class="highlight"><pre><span></span><code>refresh_token æ˜¯â€œæœ‰çŠ¶æ€â€çš„
access_token æ˜¯â€œæ— çŠ¶æ€â€çš„
</code></pre></div>

<p>ğŸ“Œ å¼¥è¡¥äº† JWT æ— æ³•ä¸»åŠ¨å¤±æ•ˆçš„ç¼ºé™·</p>
<hr>
<h3>âœ… 3. ç”¨æˆ·å‡ ä¹æ— æ„ŸçŸ¥ç»­æœŸï¼ˆä½“éªŒå¥½ï¼‰</h3>
<ul>
<li>Access Token è‡ªåŠ¨åˆ·æ–°</li>
<li>ç”¨æˆ·ä¸éœ€è¦é‡æ–°ç™»å½•</li>
<li>å‰ç«¯å¯ä»¥æ‹¦æˆª 401 â†’ è‡ªåŠ¨ refresh</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1">// å…¸å‹å‰ç«¯é€»è¾‘</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="mf">401</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">await</span><span class="w"> </span><span class="nx">refreshToken</span><span class="p">()</span>
<span class="w">  </span><span class="nx">retryRequest</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div>

<p>ğŸ“Œ <strong>ä½“éªŒæ¥è¿‘ Cookie Sessionï¼Œä½†æ›´é€‚åˆå‰åç«¯åˆ†ç¦»</strong></p>
<hr>
<h3>âœ… 4. å‡å°‘ Token è¢«é•¿æœŸæ»¥ç”¨çš„å¯èƒ½</h3>
<p>å¯¹æ¯”ä¸€ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ¡ˆ</th>
<th>Token æ³„éœ²å</th>
</tr>
</thead>
<tbody>
<tr>
<td>å• Tokenï¼ˆ30 å¤©ï¼‰</td>
<td>æ”»å‡»è€… 30 å¤©éšä¾¿ç”¨</td>
</tr>
<tr>
<td>åŒ Token</td>
<td>æ”»å‡»è€…æœ€å¤šç”¨ 10ï½30 åˆ†é’Ÿ</td>
</tr>
</tbody>
</table>
<p>ğŸ“Œ è¿™æ˜¯åŒ Token æœ€å¤§çš„å®‰å…¨æ”¶ç›Š</p>
<hr>
<h3>âœ… 5. æ›´ç¬¦åˆå®é™…å®‰å…¨åˆ†çº§</h3>
<p>åŒ Token æœ¬è´¨æ˜¯ <strong>æƒé™åˆ†å±‚</strong>ï¼š</p>
<ul>
<li>Access Tokenï¼š
  ğŸ‘‰ â€œæˆ‘ç°åœ¨èƒ½ä¸èƒ½è®¿é—®æ¥å£ï¼Ÿâ€</li>
<li>Refresh Tokenï¼š
  ğŸ‘‰ â€œæˆ‘æœ‰æ²¡æœ‰èµ„æ ¼ç»§ç»­ç™»å½•ï¼Ÿâ€</li>
</ul>
<p>ğŸ“Œ ç±»ä¼¼ã€Œä¸´æ—¶å·¥è¯ + èº«ä»½è¯ã€</p>
<hr>
<h2>å››ã€ä¸ºä»€ä¹ˆ Refresh Token ä¸€èˆ¬ä¸ç”¨ JWTï¼Ÿ</h2>
<p>å¾ˆå¤šç³»ç»Ÿä¼šè¿™æ ·è®¾è®¡ï¼š</p>
<ul>
<li>Access Tokenï¼šJWT</li>
<li>Refresh Tokenï¼šéšæœºå­—ç¬¦ä¸²ï¼ˆUUIDï¼‰</li>
</ul>
<p>åŸå› ï¼š</p>
<table>
<thead>
<tr>
<th>åŸå› </th>
<th>è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>å¯æ§æ€§</td>
<td>èƒ½éšæ—¶åŠé”€</td>
</tr>
<tr>
<td>å®‰å…¨</td>
<td>ä¸æš´éœ²ç”¨æˆ·ä¿¡æ¯</td>
</tr>
<tr>
<td>é˜²é‡æ”¾</td>
<td>å¯ç»‘å®šè®¾å¤‡ / IP</td>
</tr>
</tbody>
</table>
<p>ğŸ“Œ <strong>Refresh Token ä¸€å®šè¦å¯å¤±æ•ˆ</strong></p>
<hr>
<h2>äº”ã€åŒ Token vs Sessionï¼ˆä½ å¯èƒ½ä¼šå…³å¿ƒï¼‰</h2>
<table>
<thead>
<tr>
<th>å¯¹æ¯”é¡¹</th>
<th>Session</th>
<th>åŒ Token</th>
</tr>
</thead>
<tbody>
<tr>
<td>å‰åç«¯åˆ†ç¦»</td>
<td>âŒ</td>
<td>âœ…</td>
</tr>
<tr>
<td>æ— çŠ¶æ€æ‰©å±•</td>
<td>âŒ</td>
<td>âœ…</td>
</tr>
<tr>
<td>ç§»åŠ¨ç«¯æ”¯æŒ</td>
<td>ä¸€èˆ¬</td>
<td>å¾ˆå¥½</td>
</tr>
<tr>
<td>å®‰å…¨æ€§</td>
<td>é«˜</td>
<td>é«˜ï¼ˆè®¾è®¡å¥½ï¼‰</td>
</tr>
<tr>
<td>å¾®æœåŠ¡</td>
<td>ä¸€èˆ¬</td>
<td>éå¸¸é€‚åˆ</td>
</tr>
</tbody>
</table>
<hr>
<h2>å…­ã€ä»€ä¹ˆæ—¶å€™â€œæ²¡å¿…è¦â€ç”¨åŒ Tokenï¼Ÿ</h2>
<p>âŒ ä»¥ä¸‹æƒ…å†µå¯ä»¥ä¸å¤æ‚åŒ–ï¼š</p>
<ul>
<li>å†…éƒ¨åå°ç³»ç»Ÿ</li>
<li>çŸ­æœŸå·¥å…·</li>
<li>åªåœ¨å¯ä¿¡å†…ç½‘</li>
<li>ç”¨æˆ·é‡å¾ˆå°</li>
</ul>
<p>âœ… é€‚åˆåŒ Token çš„åœºæ™¯ï¼š</p>
<ul>
<li>Web + App</li>
<li>å‰åç«¯åˆ†ç¦»</li>
<li>å¾®æœåŠ¡</li>
<li>å¯¹å®‰å…¨æœ‰è¦æ±‚çš„ä¸šåŠ¡</li>
</ul>
<hr>
<h2>ä¸ƒã€æ€»ç»“ä¸€å¥è¯</h2>
<blockquote>
<p><strong>JWT åŒ Token æœºåˆ¶çš„ä¼˜åŠ¿åœ¨äºï¼š
ç”¨çŸ­æœŸ Token ä¿è¯å®‰å…¨ï¼Œç”¨é•¿æœŸ Token ä¿è¯ä½“éªŒï¼ŒåŒæ—¶å¼¥è¡¥ JWT æ— æ³•å¤±æ•ˆçš„ç¼ºé™·ã€‚</strong></p>
</blockquote>
      </div><!-- /.entry-content -->
        <div class="comments">
          <h2>Comments !</h2>
          <div id="disqus_thread"></div>
          <script type="text/javascript">
            var disqus_shortname = 'yinxianwei';
            var disqus_identifier = 'shuang-tokendui-bi-dan-tokenyou-na-xie-you-shi.html';
            var disqus_url = 'https://blog.yinxianwei.com/shuang-tokendui-bi-dan-tokenyou-na-xie-you-shi.html';
            (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//yinxianwei.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          </script>
          <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>

    </article>
  </section>
                <section id="extras" class="body">
                                <div class="blogroll">
                                        <h2>links</h2>
                                        <ul>
                                                        <li><a href="https://getpelican.com/">Pelican</a></li>
                                        </ul>
                                </div><!-- /.blogroll -->
                </section><!-- /#extras -->

                <footer id="contentinfo" class="body">
                        <address id="about" class="vcard body">
                                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                        </address><!-- /#about -->

                        <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
                </footer><!-- /#contentinfo -->

    
    <script>
        var link = document.createElement('a')
        link.style.marginRight = "10px"
        link.href = "https://beian.miit.gov.cn"
        link.target = "_blank"
        link.textContent = "è±«ICPå¤‡16018939å·-2"
        document.querySelector('#contentinfo > p').prepend(link)
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J8HMB6HPES"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-J8HMB6HPES');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1314323945395441"
     crossorigin="anonymous"></script>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="084e9ce4-c530-4851-8c0f-c4dd40fb0655"></script>

    <script type="text/javascript">
        var disqus_shortname = 'yinxianwei';
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
        </body>
</html>