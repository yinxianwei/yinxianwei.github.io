<!DOCTYPE html>
<html lang="zh-cn">
        <head>
                        <meta charset="utf-8" />
                        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                        <meta name="generator" content="Pelican" />
                        <title>CentOS 安装 Odoo10</title>
                        <link rel="stylesheet" href="https://blog.yinxianwei.com/theme/css/main.css" />
                                <link rel="stylesheet" href="/custom.css" />
    <meta name="description" content="postgresql 根据系统生成命令 https://www.postgresql.org/download/linux/redhat/ sudo yum install -y..." />
        </head>

        <body id="index" class="home">
    <a href="https://github.com/yinxianwei">
            <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_red_aa0000.png" alt="Fork me on GitHub" />
    </a>
                <header id="banner" class="body">
                        <h1><a href="https://blog.yinxianwei.com/">一枝红杏出墙来</a></h1>
                        <nav><ul>
                                        <li><a href="/">首页</a></li>
                                        <li><a href="/categories.html">分类</a></li>
                                        <li><a href="/tags.html">标签</a></li>
                                        <li><a href="/archives.html">归档</a></li>
                        </ul></nav>
                </header><!-- /#banner -->
  <section id="content" class="body">
    <article>
      <header>
        <h1 class="entry-title">
          <a href="https://blog.yinxianwei.com/centos-an-zhuang-odoo10.html" rel="bookmark"
             title="Permalink to CentOS 安装 Odoo10">CentOS 安装 Odoo10</a></h1>
      </header>

      <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2022-01-24T15:15:52+08:00">
                Published: Mon 24 January 2022
        </abbr>

                <address class="vcard author">
                        By                                 <a class="url fn" href="https://blog.yinxianwei.com/author/yinxianwei.html">yinxianwei</a>
                </address>
        <p>In <a href="https://blog.yinxianwei.com/category/sui-bi.html">随笔</a>.</p>
        
</footer><!-- /.post-info -->        <h2>postgresql</h2>
<!-- https://blog.csdn.net/S2T11Enterprise/article/details/109775056 -->

<ol>
<li>根据系统生成命令 https://www.postgresql.org/download/linux/redhat/</li>
<li>sudo yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-7-x86_64/pgdg-redhat-repo-latest.noarch.rpm</li>
<li>禁用内置psql <code>sudo dnf -qy module disable postgresql</code></li>
<li>安装psql <code>sudo yum install -y postgresql10-server</code></li>
<li>安装contrib <code>sudo yum install postgresql10-contrib -y</code></li>
<li>初始化 <code>sudo /usr/pgsql-10/bin/postgresql-10-setup initdb</code></li>
<li>开机启动 <code>sudo systemctl enable postgresql-10</code></li>
<li><code>sudo systemctl start postgresql-10</code></li>
<li>切换用户 <code>su - postgres</code></li>
<li><code>psql</code></li>
<li>修改默认密码 <code>alter user postgres with password 'postgres'</code></li>
<li>创建用户 <code>create user xianwei with password 'password';</code></li>
<li>创建odoo数据库 <code>create database odoo owner xianwei;</code></li>
<li>授权数据库 <code>grant all privileges on database odoo to xianwei;</code></li>
<li>ALTER USER xianwei WITH CREATEDB;</li>
<li>重启 systemctl restart postgresql-10</li>
</ol>
<h2>python2.x</h2>
<ol>
<li>yum install python2</li>
</ol>
<h2>odoo10</h2>
<ol>
<li>git clone https://gitee.com/mirrors/odoo.git --depth 1 --branch 10.0 --single-branch odoo10</li>
<li>sudo yum install libxml2-devel libxslt-devel python2-devel openldap-devel libffi-devel gcc</li>
<li>cd odoo10</li>
<li>pip2 install -r requirements.txt</li>
<li>curl -fsSL https://rpm.nodesource.com/setup_16.x | sudo bash -</li>
<li>修改 /etc/yum.repos.d/nodesource-*.repo 文件，将其中的所有 rpm.nodesource.com 替换为 mirrors.ustc.edu.cn/nodesource/rpm </li>
<li>sudo yum install -y nodejs</li>
<li>npm config set registry https://registry.npm.taobao.org</li>
<li>sudo npm install -g less@3.0.4 less-plugin-clean-css</li>
<li>vim odoo.config</li>
<li>vim /etc/systemd/system/odoo.service</li>
</ol>
<div class="highlight"><pre><span></span><code><span class="n">#修改pip镜像</span><span class="w"> </span><span class="o">~</span><span class="p">.</span><span class="n">pip</span><span class="o">/</span><span class="n">pip</span><span class="p">.</span><span class="n">config</span>
<span class="o">[</span><span class="n">global</span><span class="o">]</span>
<span class="k">index</span><span class="o">-</span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="p">.</span><span class="n">tuna</span><span class="p">.</span><span class="n">tsinghua</span><span class="p">.</span><span class="n">edu</span><span class="p">.</span><span class="n">cn</span><span class="o">/</span><span class="n">simple</span>
<span class="o">[</span><span class="n">install</span><span class="o">]</span>
<span class="n">trusted</span><span class="o">-</span><span class="k">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">pypi</span><span class="p">.</span><span class="n">tuna</span><span class="p">.</span><span class="n">tsinghua</span><span class="p">.</span><span class="n">edu</span><span class="p">.</span><span class="n">cn</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">#odoo</span><span class="p">.</span><span class="n">config</span>
<span class="o">[</span><span class="n">options</span><span class="o">]</span>
<span class="n">db_host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">localhost</span>
<span class="n">db_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5432</span>
<span class="n">addons_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">addons</span>
<span class="n">db_user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xianwei</span>
<span class="n">db_password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">password</span>
<span class="n">dbfilter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">odoo</span>
<span class="nf">db_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">odoo</span>
<span class="n">addons_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">local</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">odoo</span><span class="o">/</span><span class="n">addons</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">#/etc/systemd/system/odoo.service</span>
<span class="k">[Unit]</span>
<span class="na">Description</span><span class="o">=</span><span class="s">Odoo</span>
<span class="na">After</span><span class="o">=</span><span class="s">postgresql-10.service</span>

<span class="k">[Service]</span>
<span class="na">Type</span><span class="o">=</span><span class="s">simple</span>
<span class="na">User</span><span class="o">=</span><span class="s">xianwei</span>
<span class="na">Group</span><span class="o">=</span><span class="s">xianwei</span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/usr/bin/python2 /usr/local/app/odoo/odoo-bin -c /usr/local/app/odoo/odoo.conf</span>

<span class="k">[Install]</span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span>
</code></pre></div>

<h2>问题</h2>
<ol>
<li>OptionBinding with id "failovermethod" does not exist
    <code>sudo sed -iBAK '/^failovermethod=/d' /etc/yum.repos.d/*.repo</code></li>
<li>centos添加用户<ol>
<li>adduser xianwei</li>
<li>chmod -v u+w /etc/sudoers</li>
<li>vim /etc/sudoers</li>
<li>xianwei ALL=(ALL)       ALL</li>
<li>chmod -v u-w /etc/sudoers</li>
</ol>
</li>
<li>忘记psql密码<ol>
<li>修改/var/lib/pgsql/10/data/pg_hba.conf的local为trust</li>
</ol>
</li>
<li>远程访问<ol>
<li>修改/var/lib/pgsql/10/data/postgresql.conf文件中的listen_addresses为*</li>
<li>/var/lib/pgsql/10/data/pg_hba.conf添加
<code>host    all             xianwei             0.0.0.0/0               md5</code></li>
</ol>
</li>
</ol>
      </div><!-- /.entry-content -->
        <div class="comments">
          <h2>Comments !</h2>
          <div id="disqus_thread"></div>
          <script type="text/javascript">
            var disqus_shortname = 'yinxianwei';
            var disqus_identifier = 'centos-an-zhuang-odoo10.html';
            var disqus_url = 'https://blog.yinxianwei.com/centos-an-zhuang-odoo10.html';
            (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//yinxianwei.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
          </script>
          <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>

    </article>
  </section>
                <section id="extras" class="body">
                                <div class="blogroll">
                                        <h2>links</h2>
                                        <ul>
                                                        <li><a href="https://getpelican.com/">Pelican</a></li>
                                        </ul>
                                </div><!-- /.blogroll -->
                </section><!-- /#extras -->

                <footer id="contentinfo" class="body">
                        <address id="about" class="vcard body">
                                Proudly powered by <a rel="nofollow" href="https://getpelican.com/">Pelican</a>, which takes great advantage of <a rel="nofollow" href="https://www.python.org/">Python</a>.
                        </address><!-- /#about -->

                        <p>The theme is by <a rel="nofollow" href="https://www.smashingmagazine.com/2009/08/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
                </footer><!-- /#contentinfo -->

    
    <script>
        var link = document.createElement('a')
        link.style.marginRight = "10px"
        link.href = "https://beian.miit.gov.cn"
        link.target = "_blank"
        link.textContent = "豫ICP备16018939号-2"
        document.querySelector('#contentinfo > p').prepend(link)
    </script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-J8HMB6HPES"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-J8HMB6HPES');
    </script>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1314323945395441"
     crossorigin="anonymous"></script>
    <script defer src="https://cloud.umami.is/script.js" data-website-id="084e9ce4-c530-4851-8c0f-c4dd40fb0655"></script>

    <script type="text/javascript">
        var disqus_shortname = 'yinxianwei';
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = 'https://' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
        </body>
</html>